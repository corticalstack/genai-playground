alpaca_prompt = """Below is an instruction that describes a task, paired with an input that provides further context. Write a response that appropriately completes the request.

### Instruction:
{}

### Response:
{}"""



def formatting_prompts_func(examples):
    convos = examples["conversations"]
    texts = []
    for convo in convos:
        human_dict = convo[0]
        gpt_dict = convo[1]
        instruction = human_dict['value']
        response = gpt_dict['value']
        text = alpaca_prompt.format(instruction, response) + EOS_TOKEN
        texts.append(text)
    return { "text" : texts, }

train_dataset_in_prompt_format = train_dataset.map(format_prompts, batched = True,)